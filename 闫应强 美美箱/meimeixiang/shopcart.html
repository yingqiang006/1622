<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8" />
		<title></title>
		<link type="text/css" rel="stylesheet" href="css/shopcart.css"  />
		<link type="text/css" rel="stylesheet" href="css/equal.css" />
	</head>

	<body>
		<div class="zhongji">
			<img src="img/szj.png" class="szjp1" />
			<img src="img/szjqr.png" class="szjp2"  />
			<a href="javascript:void(0)" class="szjclose"></a>
			<a href="javascript:void(0)" class="szjload"></a>
		</div>
		<div class="fixrig">
			<div class="fixrig-s"></div>
			<ul class="meifix">
				<li class="cart" id="cartsh">
					<a href="#" id="cart">
						<i class="carti"></i>
						<span class="cart-name">
							购物车
						</span>
					</a>
				</li>
				<li class="precen">
					<a href="#" id=""><i class="preceni"></i></a>
					<div class="cangout"><div class="cangout1"></div><div class="yincang"><i class=""></i>个人中心</div></div>
					
				</li>
				<li class="collect">
					<a href="#" id=""><i class="collecti"></i></a>
					<div class="cangout"><div class="cangout1"></div><div class="yincang"><i class=""></i>我的收藏</div></div>
					
				</li>
				<li class="order">
					<a href="#" id=""><i class="orderi"></i></a>
					<div class="cangout"><div class="cangout1"></div><div class="yincang"><i class=""></i>我的订单</div></div>
					
				</li>
				<li class="service">
					<a href="#" id=""><i class="servicei"></i></a>
					<div class="cangout"><div class="cangout1"></div><div class="yincang"><i class=""></i>在线客服</div></div>
					
				</li>
				<li class="totop" id="totop" style="position: fixed; bottom: 20px; display: none;">
					<a href="javascript:void(0);" ><i class="totopi"></i></a>
					<div class="cangout"><div class="cangout1"></div><div class="yincang"><i class=""></i>回到顶部</div></div>
					
				</li>
			</ul>
			<div class="shop">
				<div class="shop-head">
					<span>购物车</span>
					<i id="shopclose"></i>
				</div>
				
					<div class=""></div>
					<div class="shopbt">
						<ul id="insul">
							<li class="insulli">
								<div class="islil"></div>
								<div class="islir"></div>
							</li>
						</ul>
					</div>
					<div class="shopbb">
						<div class="shopbbt">
							<p class="shopp1">共<span id="indexcount1">0</span>件商品</p>
							<p class="shopp2">总计<span id="indexcount2">￥0.00</span></p>
						</div>
						<a class="goshop" href="shopcart.html">去购物车结算</a>
					</div>
				
			</div>
		</div>
		<div class="topout">
			<div class="top">
				<div class="topl">
					<img src="img/xin.jpg" />
					<span class="s1">100%韩国正品美美箱</span>

					<a id="daywr" href="#"><img src="img/rili.jpg" />[每日签到]</a>
					<span>每月累计签到满10次，即可获得5蜜豆</span>
				</div>
				<div class="topr">
					<a href="login.html">登录</a>
					<a href="register.html">注册</a>
					<span>|</span>
					<a href="#"><img src="img/shouji.jpg" />手机APP</a>

					<a href="#"><img src="img/erji.jpg" />在线客服</a>
					
				</div>

			</div>
		</div>
		<div class="logoout" style="border: none;">
			<div class="logorea">
				<div class="logo">
					<a href="index.html">
						<img src="img/logo.png" />
					</a>
				</div>
				<div class="logoright">
					<ul class="sclr">
						<li class="llli1">
							<span class="sfirst">1</span>
							<div class="dfirst">购物车</div>
						</li>
						<li class="llli2">
							<span>2</span>
							<i ></i>
							<div class="">提交订单</div>
						</li>
						<li class="llli3">
							<i></i>
							<span class="duihao">3</span>
							<div class="">选择支付</div>
						</li>
					</ul>
				</div>	
			</div>
		</div>
		<div class="sc-containout">
			<div class="sc-contain">
				<div class="sc-con-top">
					<div class="sccttop">
						<div class="scctt1"><span>中国仓</span>满99元包邮</div>
						<div class="scctt2">规格</div>
						<div class="scctt3">单价（元）</div>
						<div class="scctt4">数量</div>
						<div class="scctt5">金额（元）</div>
						<div class="scctt6">操作</div>
					</div>
					<div class="scctcen">
						<div class="scctcon">
							<div class="scctc1">
								
								<a class="tcc1" href="#">
									<img src="img/goods11.jpg" />
								</a>
								<div class="tcc2par">
								<a class="tcc2" href="#">IM我爱魔法棒特别套装_#04 月光+#03 铜光+我爱多功能彩妆刷 #BO18</a>
								</div>
							</div>
							<div class="scctc2">
								-- 
							</div>
							<div class="scctc3">
								￥149.00
							</div>
							<div class="scctc4">
								<div class="tc41">
									<button name="btn1">-</button>
									<input type="text" value="3"/>
									<button name="btn2">+</button>
									
								</div>
							</div>
							<div class="scctc5">￥447</div>
							<div class="scctc6">
								<p class="">移入我的收藏</p>
								<p class="tc6p" name="delete">删除</p>
							</div>
							
						</div>
					</div>
					<div class="scctbon">
						<div class="stb">
							<span class="stbs1">本仓总计：</span>
							<span class="stbs2">￥913.00</span>
						</div>
					</div>
				</div>
				<div class="sc-con-bot" id="huaout">
					<div class="sclast" id="huadong">
						<a class="jijia" href="#">去结算</a>
						<div class="sclast1">
							<span>总计</span>
							<span class="zongjia">￥913.00</span>
							<span>(不含运费)</span>
						</div>
						
					</div>
				</div>
			</div>
		</div>
		<div class="lasttout">
			<div class="ldiv"><img src="img/genuine.png" /><div>100%正品</div></div>
			<div class="ldiv"><img src="img/low.png" /><div>优质低价</div></div>
			<div class="ldiv"><img src="img/deliver.png" /><div>极速发货</div></div>
			<div class="ldiv"><img src="img/refund.png" /><div>退换无忧</div></div>
		</div>
		<div class="lastout">
			<div class="lastleft">
				<div class="lasl1">
					<img src="img/szj.jpg" />
				</div>
				<p>关于我们</p>
				<div class="guanyu">
					<div class="guanyu1">
						<img class="meme m2" src="img/meme.png"  />
						<img class="memeout" src="img/download.png"  />
					</div>
					<div class="guanyu2">
						<img class="meme m2" src="img/wechat.png"  />
						<img class="memeout" src="img/wechatdownload.png"  />
					</div>
					<div class="guanyu3">
						<img class="meme m2" src="img/sina.png"  />
						<img class="memeout" src="img/sinadownload.png"  />
					</div>
				</div>
			</div>
			<div class="lastright">
				<ul class="lr-ul">
					<li class="lru-f">关于美美箱</li>
					<li ><a href="#">美美全球</a></li>
					<li ><a href="#">品牌优势</a></li>
					<li ><a href="#">消费保障</a></li>
				</ul>
				<ul class="lr-ul">
					<li class="lru-f">帮助中心</li>
					<li ><a href="#">常见问题</a></li>
					<li ><a href="#">账户相关</a></li>
					<li ><a href="#">包邮政策</a></li>
					<li ><a href="#">支付相关</a></li>
					<li ><a href="#">物流相关</a></li>
					<li ><a href="#">退换政策</a></li>
				</ul>
				<ul class="lr-ul">
					<li class="lru-f">服务协议</li>
					<li ><a href="#">服务协议</a></li>
					<li ><a href="#">个人网申协议</a></li>
					
				</ul>
				<ul class="lr-ul">
					<li class="lru-f">联系我们</li>
					<li ><a href="#">商务合作</a></li>
					<li ><a href="#">分销合作</a></li>
					<li ><a href="#">加入我们</a></li>
				</ul>
				
			</div>
		</div>
		<div class="lianxi">
			<h2>联系客服</h2>
			<p>
				<span>客服时间：周一~周日(9:00 - 21:00)</span>
				<span>客服热线：400-720-9967</span>
				<span>客服邮箱：kf@memeboxglobal.com</span>
			</p>
		</div>
		<div class="lbottom">
			<p class="lbp1">&copy;2015 Memebox Corporation. All Rights Reserved.</p>
			<p class="lbp2">
				<img src="img/icon.gif" />
				<span>
					蜜米柏斯克(上海)商贸有限公司 上海市杨浦区政立路415号中航天盛广场A座6楼 沪ICP备14043341号
			</span></p>
		</div>
		<div class="zhezhao">
			
		</div>
		<div class="qiandao">
			<div class="qiani" id="close"><i></i></div>
			<p class="qianp1">下载APP，签到赢蜜豆</p>
			<div class="qianpic">
				<img src="img/qrcode@1x.jpg" />
			</div>
			<p class="qianp2">每月累计签到满10次，即可获得5蜜豆</p>
			
		</div>
		<script src="js/jquery-1.12.4.min.js"></script>
		<script src="js/handlebars.min.js"></script>
		<script src="js/picCarou.js"></script>
		<script src="js/CookieUtil.js"></script>
		
		<script type="text/x-handlebars-template" id="stp">
			{{#each this}}
			<div class="scctcon">
				<div class="scctc1">
					<a class="tcc1" href="#">
						<img src="img/{{this.images}}" />
					</a>
					
					<a class="tcc2" href="#">{{this.name1}}{{this.name2}}</a>
				</div>
				<div class="scctc2">
					-- 
				</div>
				<div class="scctc3">
					￥{{this.price}}
				</div>
				<div class="scctc4">
					<div class="tc41">
						<button>-</button>
						<input type="text" value="{{this.count}}"/>
						<button>+</button>
						
					</div>
				</div>
				<div class="scctc5">￥{{this.price}}*{{this.count}}</div>
				<div class="scctc6">
					<p class="">移入我的收藏</p>
					<p class="">删除</p>
				</div>
				
			</div>
			{{/each}}
		</script>
		<script id="xtp" type="text/x-handlebars-template">
			{{#each this}}
			<li class="insulli">
				<img class="leftimg" src="img/{{this.images}}" />
				<div class="rigdiv">
					<a>{{this.name1}}{{this.name2}}</a>
					<div>
						<button name="btn1">-</button>
						<input type="text" value="{{this.count}}" />
						<button name="btn2">+</button>
					</div>
					<span>￥{{this.price}}.00</span>
					<i></i>
				</div>
			</li>
			{{/each}}
		</script>
		<script>
			
			$(function() {
				//总价的结算div运动
				var $scctcen = $(".scctcen");
				var $huahua = $("#huaout");
				var $hua = $("#huadong");
				//console.log($hua);
				//console.log($huahua.offset().top);
				$(window).scroll(function(){
					var st = $(window).scrollTop()+$(window).height();
					console.log()
					var boundVal= $huahua.offset().top+62;
					//console.log(st);
					//console.log(boundVal);
					if(st < boundVal){
						$hua.css({position:"fixed", bottom: 0});
					} else{
						$hua.css({position: "relative"});
					}
				});
				//
				function getAllCookie(){
				var value = CookieUtil.getCookie("cart");
				if(!value){
					return [];
				}
					return JSON.parse(value);
				}
				var cookiearr = getAllCookie();
				var Cookiearr = null;
				
				//console.log(cookiearr);
				function addBig(){
					var htmlstr2 = "";
					cookiearr = getAllCookie();
					for(var i in cookiearr) {
						var objs = cookiearr[i];
						htmlstr2 += '<div class="scctcon">'+'<div class="scctc1">'+'<a class="tcc1" href="#">'+'<img src="img/'+objs.images+' "/>'+'</a>'+
									'<div class="tcc2par">'+'<a class="tcc2" href="#">'+objs.name1+objs.name2+'</a>'+'</div>'+
								'</div>'+
								'<div class="scctc2">'+
									'--'+ 
								'</div>'+
								'<div class="scctc3">'+
									'￥'+objs.price+'.00'+
								'</div>'+
								'<div class="scctc4">'+
									'<div class="tc41">'+
										'<button name="btn1">-</button>'+
										'<input type="text" value="'+objs.count+'"/>'+
										'<button name="btn2">+</button>'+
									'</div>'+
								'</div>'+
								'<div class="scctc5">￥'+objs.count*objs.price+'.00</div>'+
								'<div class="scctc6">'+
									'<p class="">移入我的收藏</p>'+
									'<p class="tc6p">删除</p>'+
								'</div>'+
							'</div>';
					}
					
					
					$scctcen.html(htmlstr2);
					computing();
					scc();
				}
				addBig();
				
				function computing(){
					var totalCount = 0;
					var totalAmount = 0;
					for(var i in cookiearr) {
						var obj = cookiearr[i];
						totalCount += obj.count;
						totalAmount += obj.count * obj.price;
					}
					$(".stbs2").html("￥" + totalAmount + ".00");
					$(".zongjia").html("￥" + totalAmount + ".00");
					$("#indexcount1").html(totalCount);
					$("#indexcount2").html("￥" + totalAmount + ".00");
				}
				var reg = /^[1-9]\d{0,3}$/;
				function scc(){
					//点击按钮对商品数量进行修改
					$scctcen.find("button").click(function() {
						//var cookiearr = getAllCookie();
						var $par = $(this).parent().parent();
						console.log(this.getAttribute("name"));
						if(this.getAttribute("name") == "btn1"){
							var index = $par.parent().index();
							var $next = $(this).next();
							if(cookiearr[index].count == 1){
								$(this).attr({disabled:true});
							} else{
								$next.val(parseInt($next.val())-1);
								cookiearr[index].count--;
							}
							
						}else if(this.getAttribute("name") == "btn2"){
							
							var $pre = $(this).prev();
							$pre.val(parseInt($pre.val())+1);
							var index =$par.parent().index();
							cookiearr[index].count++;
							$(this).siblings().eq(0).attr({disabled: false});
						}
						$par.next().html("￥"+cookiearr[index].count * cookiearr[index].price+".00");
							computing();
							CookieUtil.saveCookie("cart",JSON.stringify(cookiearr));
							addShop();
					});
					
					$scctcen.find("input").blur(function(){
						var reg = /^[1-9]\d{0,3}$/;
						var $par = $(this).parent().parent();
						var index = $par.parent().index();
						if(reg.test(this.value)){
							cookiearr[index].count = parseInt(this.value);
							$par.next().html("￥"+cookiearr[index].count * cookiearr[index].price+".00");
						} else {
							this.value = cookiearr[index].count;
						}
						if(this.value == 1){
							$(this).prev().attr({disabled: true});
						}else{
							$(this).prev().attr({disabled: false});
						}
						computing();
						CookieUtil.saveCookie("cart",JSON.stringify(cookiearr));
						addShop();
					});
					$scctcen.find(".tc6p").click(function(){
						console.log(this);
						var index = $(this).parent().parent().index();
						$(this).parent().parent().remove();
						cookiearr.splice(index,1);
						CookieUtil.saveCookie("cart",JSON.stringify(cookiearr));
						computing();
						addShop();
					});
				}
				function addShop(){
					Cookiearr = getAllCookie();
					var tempFnx = Handlebars.compile($("#xtp").html());
					var htmlstr = tempFnx(Cookiearr);
					$("#insul").html(htmlstr);
					computing()
					insul();
				}
				addShop();
				function insul(){
					$("#insul").find("button").click(function(){
						cookiearr = getAllCookie();
						var $par = $(this).parent().parent();
						console.log($par);
						console.log(this.getAttribute("name"));
						if(this.getAttribute("name") == "btn1"){
							var index = $par.parent().index();
							var $next = $(this).next();
							if(cookiearr[index].count == 1){
								$(this).attr({disabled:true});
							} else{
								$next.val(parseInt($next.val())-1);
								cookiearr[index].count--;
							}
							
						}else if(this.getAttribute("name") == "btn2"){
							
							var $pre = $(this).prev();
							$pre.val(parseInt($pre.val())+1);
							var index =$par.parent().index();
							cookiearr[index].count++;
							$(this).siblings().eq(0).attr({disabled: false});
						}
						
							computing();
							CookieUtil.saveCookie("cart",JSON.stringify(cookiearr));
							addBig();
					})
					$("#insul").find("i").click(function(){
						cookiearr = getAllCookie();
						var index = $(this).parent().parent().index();
						console.log(index);
						console.log(cookiearr);
						$(this).parent().parent().remove();
						cookiearr.splice(index,1);
						console.log(cookiearr);
						CookieUtil.saveCookie("cart",JSON.stringify(cookiearr));
						computing();
						addBig();
					});
					$("#insul").find("input").blur(function(){
						var reg = /^[1-9]\d{0,3}$/;
						var $par = $(this).parent().parent();
						var index = $par.parent().index();
						if(reg.test(this.value)){
							cookiearr[index].count = parseInt(this.value);
							$par.next().html("￥"+cookiearr[index].count * cookiearr[index].price+".00");
						} else {
							this.value = cookiearr[index].count;
						}
						if(this.value == 1){
							$(this).prev().attr({disabled: true});
						}else{
							$(this).prev().attr({disabled: false});
						}
						computing();
						CookieUtil.saveCookie("cart",JSON.stringify(cookiearr));
						addBig();
					});
				}
			});
			
			
			
		</script>
		<script>
			$(function () {
				var $flnavs = $("#floornav li");
				var $goods = $(".nobanout .goods");
				var $noban = $(".nobanout .noban");
				var ifNeed = true;
				
				//滚动出现回到顶部图标
				$(window).scroll(function() {
					var st = $(window).scrollTop();
					if(st > 200) {
						$("#totop").css({display: "block"});
					} else{
						$("#totop").css({display: "none"});
					}
					if(st > 500) {
						$("#floornav").css({display: "block"});
					}else {
						$("#floornav").css({display: "none"});
					}
					
					/*if(ifNeed == true) {
						for(var i = 0; i<4; i++) {
							var boundValue = $goods.eq(i).offset().top - 200;
							if(st < boundValue) {
								
									$flnavs.eq(i).addClass("select").siblings().removeClass("select");
			
								
								break;
							}
						}
					}*/
				});
				//回到顶部
				$("#totop").click(function(){
					$("body, html").animate({scrollTop: 0});
				});
				
				//右部条形栏动画
				$(".meifix li").mouseenter(function() {
					$(this).find(".cangout").stop(true).css({right: 80,display:"block"}).animate({right:40});
				}).mouseleave(function(){
					$(this).find(".cangout").stop(true).css({display: "none"});
				});
				$("#cartsh").click(function() {
					if($(".shop").css("display") == "block"){
						
					} else {
						$(".shop").stop(true).css({left: 0,display:"block"}).animate({left: -285});
					}
						
					
				});
				$("#shopclose").click(function() {
						$(".shop").stop(true).animate({left: 0},function() {
							$(this).css({display: "none"});
						});
				})
				//每日签到
				$("#daywr").click(function() {
					$(".zhezhao").css({display: "block"});
					$(".qiandao").css({display: "block"});
					$(".shop").css({display: "none"});
				});
				$("#close").click(function() {
					$(".zhezhao").css({display: "none"});
					$(".qiandao").css({display: "none"});
				});
				//楼梯效果
				
 				$flnavs.click(function(){
 					ifNeed = false;
					var index = $(this).index();
					var ot;
					if(index == 0) {
						ot = $noban.offset().top;
					} else {
						ot = $goods.eq(index-1).offset().top;
					}
					$("body, html").stop(true).animate({scrollTop: ot},function(){
						ifNeed = true
					});
					$(this).addClass("select").siblings().removeClass("select");
				});
				
				
				//关于我们 点击事件
		  		$(".guanyu").find(".meme").mouseenter(function() {
					
					var index = $(this).index(".meme");
					
					$(".guanyu .memeout").eq(index).css({display: "block"});
				}).mouseleave(function() {
					var index = $(this).index(".meme");
					$(".guanyu .memeout").eq(index).css({display: "none"});
				});
				//宋仲基点击下载
				$(".szjload").click(function(){
					$(".szjp2").css({display: "block"});
					$(".szjclose").css({display: "block"});
					
				});
				$(".szjclose").click(function(){
					$(".szjp2").css({display: "none"});
					$(".szjclose").css({display: "none"});
				});
				
				
				
				
			});
		</script>
	</body>
</html>
